<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Datamaker MS-Excel Multiple Choice Test</title>
  <style>
    :root{
      --accent:#107C41;
      --card-bg:#fff;
      --page-bg:#f4f4f4;
      --muted:#666;
      --maxw:980px;
    }
    body{
      margin:0;
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--page-bg);
      color:#111;
      -webkit-font-smoothing:antialiased;
    }
    .topbar {
      background:var(--accent);
      color:white;
      padding:22px 16px;
      text-align:center;
      font-size:1.25rem;
      font-weight:600;
    }
    .wrap{
      max-width:var(--maxw);
      margin:28px auto;
      padding:0 16px;
    }
    .card{
      background:var(--card-bg);
      border-radius:10px;
      box-shadow:0 6px 18px rgba(16,124,65,0.06);
      padding:28px;
      overflow:auto;
    }
    .intro{
      color:var(--muted);
      margin-bottom:18px;
      font-size:0.95rem;
    }
    .meta{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom:18px;
    }
    .meta .field{
      flex:1 1 260px;
    }
    label.input-label{
      display:block;
      font-weight:600;
      margin-bottom:6px;
    }
    input[type="text"], input[type="email"]{
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #d0d0d0;
      font-size:0.98rem;
    }
    hr.sep{ border:none; height:1px; background:#eef2f0; margin:20px 0; }
    .question{
      margin-bottom:14px;
      padding:12px;
      border-radius:8px;
      background:#fcfffd;
      border:1px solid #f0f6f1;
    }
    .q-header{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .q-number{
      min-width:36px;
      height:36px;
      border-radius:50%;
      background:var(--accent);
      color:white;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      box-shadow:0 2px 6px rgba(16,124,65,0.12);
    }
    .q-text{
      font-weight:600;
      font-size:0.98rem;
      flex:1 1 auto;
    }
    .options{
      margin-top:8px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .option-label{
      display:flex;
      gap:12px;
      align-items:center;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #eee;
      cursor:pointer;
      user-select:none;
    }
    .option-label:hover{ background:#fafdf9; }
    .option-label input{ transform:scale(1.02); margin:0; }
    .submit-row{
      margin-top:20px;
      display:flex;
      justify-content:flex-end;
      gap:12px;
      align-items:center;
    }
    button.submit-btn{
      background:var(--accent);
      color:white;
      padding:12px 18px;
      border-radius:8px;
      border:none;
      font-weight:700;
      cursor:pointer;
      font-size:1rem;
    }
    button.submit-btn:hover{ background:#0e6b39; }
    .note{ color:var(--muted); font-size:0.95rem; margin-top:6px; }
    @media (max-width:720px){
      .meta{ flex-direction:column; }
      .submit-row{ justify-content:center; }
    }
  </style>
</head>
<body>
  <div class="topbar">Datamaker MS-Excel Multiple Choice Test</div>

  <div class="wrap">
    <div class="card">
      <p class="intro">
        Hi! Would you mind completing this quiz? This is to help us evaluate your understanding of the training you were given. Thank you!
        <br><strong>Total: 52 Questions</strong>
      </p>

      <form id="testForm" autocomplete="off" onsubmit="return handleSubmit(event)">

        <!-- Q1 & Q2 fixed at top -->
        <div class="meta">
          <div class="field">
            <label class="input-label" for="name">Q1 — Name *</label>
            <input id="name" name="name" type="text" required />
          </div>
          <div class="field">
            <label class="input-label" for="email">Q2 — Email *</label>
            <input id="email" name="email" type="email" required />
          </div>
        </div>

        <hr class="sep" />

        <!-- Container for MCQs Q3..Q52 (shuffled) -->
        <div id="questionsContainer"></div>

        <div class="submit-row">
          <div class="note">Note: Leaving or refreshing will restart the test and reshuffle questions.</div>
          <button type="submit" class="submit-btn">Submit</button>
        </div>

        <p class="note">This content is neither created nor endorsed by Microsoft. The data you submit will be sent to the form owner.</p>

      </form>
    </div>
  </div>

  <script>
  // your Apps Script URL
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyZcd550lbk_2tpBl_kYhes-bf9YnriHi3NAoV6jRGPcLDUUCpUJPh2lzmWxmlb0oyYMg/exec";

  // Q3..Q52 (50 MCQs)
  const mcQuestions = [
    {id:3, q:"What is Microsoft Word?", opts:["A web browser","A spreadsheet application","A word processing software","A video editing software"], answer:"c"},
    {id:4, q:"Which ribbon tab in Microsoft Word is used for formatting text?", opts:["Home","Insert","Page Layout","Review"], answer:"a"},
    {id:5, q:"Which keyboard shortcut is used to bold text in Microsoft Word?", opts:["Ctrl + I","Ctrl + U","Ctrl + P","Ctrl + B"], answer:"d"},
    {id:6, q:"Which option in Microsoft Word is used to save a document?", opts:["Save and Close","Save and Send","Save As","Save and Publish"], answer:"c"},
    {id:7, q:"Which feature in Microsoft Word is used to check spelling and grammar errors?", opts:["AutoCorrect","AutoSummarize","Word Count","Spelling and Grammar"], answer:"d"},
    {id:8, q:"Which ribbon tab in Microsoft Word is used for adding tables?", opts:["Home","Insert","Page Layout","Review"], answer:"b"},
    {id:9, q:"Which keyboard shortcut is used to undo the last action in Microsoft Word?", opts:["Ctrl + Z","Ctrl + Y","Ctrl + X","Ctrl + C"], answer:"a"},
    {id:10, q:"We can insert a page number at?", opts:["Header","Footer","None","Both A an B"], answer:"d"},
    {id:11, q:"Which ribbon tab in Microsoft Word is used for adding page numbers?", opts:["Home","Insert","Page Layout","Review"], answer:"b"},
    {id:12, q:"Which keyboard shortcut is used to align text to the center in Microsoft Word?", opts:["Ctrl + L","Ctrl + R","Ctrl + E","Ctrl + J"], answer:"c"},
    {id:13, q:"Which of the following keyboard shortcuts is used to save a Microsoft Word document?", opts:["Ctrl + A","Ctrl + S","Ctrl + C","Ctrl + V"], answer:"b"},
    {id:14, q:"Which of the following is not a type of page orientation in Microsoft Word?", opts:["Portrait","Square","Mirror","Landscape"], answer:"b"},
    {id:15, q:"Which of the following is not a type of page break in Microsoft Word?", opts:["Next Page","Continuous","Column","Section Break"], answer:"d"},
    {id:16, q:"Which of the following is not a type of alignment in Microsoft Word?", opts:["Left","Right","Center","Justified","Hanging"], answer:"e"},
    {id:17, q:"Which of the following is not part of the type of list?", opts:["Bulleted List","Single-level List","Numbered List","Multilevel List"], answer:"b"},
    {id:18, q:"The Space left between the margin and the start of a paragraph is called", opts:["Spacing","Gutter","Indentation","Alignment"], answer:"c"},
    {id:19, q:"What does the acronym WYSIWYG stand for in relation to Microsoft Word?", opts:["What You Send Is What You Get","What You Set Is What You Gain","What You See Is What You Get","What You Save Is What You Generate"], answer:"c"},
    {id:20, q:"Which ribbon tab is used to change the font style, size, and color in Microsoft Word?", opts:["Review","Insert","Page Layout","Home"], answer:"d"},
    {id:21, q:"In which view of MS Word are headers and footers visible?", opts:["Normal View","Print Layout View","Page Layout View","Draft View"], answer:"b"},
    {id:22, q:"Text-Styling feature in MS Word is known as", opts:["WordArt","WordColour","WordFont","WordFill"], answer:"a"},
    {id:23, q:"Which of the following MS-Word features crosses texts out by drawing a line through it?", opts:["Pagination","Underline","Strikethrough","Subscript","None of the above"], answer:"c"},
    {id:24, q:"When opening a new document in Microsoft Word, the default font size is?", opts:["10 point","12 point","16 point","11 point"], answer:"d"},
    {id:25, q:"What is the default font style in MS Word?", opts:["Calibri","Times New Roman","Arial","Malgun Gothic"], answer:"a"},
    {id:26, q:"What is shortcut key to open the 'Font' Dialogue box in MS-Word?", opts:["Alt+F","Ctrl+D","Ctrl+F","Alt+Ctrl+D"], answer:"b"},
    {id:27, q:"In MS Word, a character that is raised and is smaller above the baseline is known as", opts:["Superscript","Raised","Outlined","Subscript"], answer:"a"},
    {id:28, q:"The valid format for saving of a MS Word document is", opts:[".jpeg",".doc",".pdf",".txt",".pptx"], answer:"b"},
    {id:29, q:"What do you call the distance between the written text and the edge of a paper?", opts:["Alignment","Ruler line","Indent Stop","Margin"], answer:"d"},
    {id:30, q:"…. are the blank spaces found at line the top, bottom, left, and, right sides a document", opts:["Spacings","Margins","Indentations","Alignments"], answer:"b"},
    {id:31, q:"All the following are shortcuts for alignments except?", opts:["Ctrl+D","Ctrl+L","Ctrl+E","Ctrl+R","Ctrl+J","None of the above"], answer:"a"},
    {id:32, q:"What is the shortcut to increase the font size of a text by 1 point?", opts:["Ctrl+]","Ctrl+[","Ctrl+1","Ctrl+I"], answer:"a"},
    {id:33, q:"What is the shortcut to decrease the font size of a text by 1 point?", opts:["Ctrl+1","Ctrl+]","Ctrl+I","Ctrl+[","Ctrl+Y"], answer:"d"},
    {id:34, q:"What is the shortcut for cutting a text in MS-Word?", opts:["Ctrl+C","Ctrl+X","Ctrl+V","Ctrl+Z","Ctrl+K"], answer:"b"},
    {id:35, q:"Which of the following is not a type of document view in Microsoft Word?", opts:["Draft","Print Layout","Web Layout","Handwriting"], answer:"d"},
    {id:36, q:"Which Toolbar is located directly next to the Microsoft Office Button?", opts:["Title Bar","Ribbon","Search toolbar","Quick Access Toolbar"], answer:"d"},
    {id:37, q:"Which Bar shows the document's or application name when it is opened in MS Word?", opts:["Quick Access Toolbar","Title Bar","Home tab","Ribbon"], answer:"b"},
    {id:38, q:"The number of tabs in the ribbon of Microsoft Word depends on the version...", opts:["True","False"], answer:"a"},
    {id:39, q:"There are several ways to save a Microsoft Word document, these includes all except?", opts:["Click the Save button","Click File > Save/Save As","Type name in title bar","Ctrl+S","Ctrl+Shift+S"], answer:"c"},
    {id:40, q:"Which procedure helps you save a Word doc as a PDF?", opts:["Option A","Option B","Option C","All of the above"], answer:"d"},
    {id:41, q:"Which of the following is used to change text colour in an MS Word document?", opts:["Font color","Text highlight colour","Shading","Styles","None of the above","All of the above"], answer:"a"},
    {id:42, q:"What is the purpose of sharing a Word document with others?", opts:["Show off","Backup","Collaborate","Keep private"], answer:"c"},
    {id:43, q:"Which feature allows you to share via email/cloud?", opts:["Save As","Track Changes","Comments","Share"], answer:"d"},
    {id:44, q:"Benefit of saving to OneDrive/SharePoint?", opts:["Local backup","Access anywhere","Better formatting","Prevent editing"], answer:"b"},
    {id:45, q:"Which option in Spelling & Grammar allows you to add to dictionary?", opts:["Add to Dictionary","Add","Ignore","Add to Thesaurus"], answer:"a"},
    {id:46, q:"Proofreading technique reading backwards?", opts:["Chunking","Scanning","Skimming","Reverse Reading"], answer:"d"},
    {id:47, q:"Proofreading technique reading aloud?", opts:["Reading Out Loud","Reciting","Reading Loud","Grammar Checker"], answer:"a"},
    {id:48, q:"Which option in Spelling & Grammar auto corrects?", opts:["AutoRight","Ignore All","AutoCorrect","Change","None"], answer:"c"},
    {id:49, q:"Proofreading technique reading quickly for overview?", opts:["Skimming","Scanning","Chunking","AutoCorrect"], answer:"a"},
    {id:50, q:"Purpose of Review tab in Word?", opts:["Collaboration","Format text","Add headers/footers","Track changes/comments"], answer:"d"},
    {id:51, q:"Purpose of co-authoring in Word?", opts:["Save different format","Track changes","Work together","Help typing","None"], answer:"c"},
    {id:52, q:"Shortcut to select all in a doc?", opts:["Ctrl+A","Ctrl+C","Ctrl+D","Ctrl+U"], answer:"a"},
    }
  ];

  // UTILS
  function shuffleArray(a){
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i], a[j]] = [a[j], a[i]];
    }
  }
  function escapeHtml(s){
    return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;');
  }

  // Render MCQs (shuffle questions and options)
  function renderMCQs(){
    const container = document.getElementById('questionsContainer');
    container.innerHTML = '';
    const qs = JSON.parse(JSON.stringify(mcQuestions));
    shuffleArray(qs); // shuffle question order
    qs.forEach((q) => {
      shuffleArray(q.options); // shuffle options
      const qDiv = document.createElement('div');
      qDiv.className = 'question';
      qDiv.id = 'q' + q.id;

      const header = document.createElement('div');
      header.className = 'q-header';
      header.innerHTML = `<div class="q-number">${q.id}</div><div class="q-text">${escapeHtml(q.text)}</div>`;
      qDiv.appendChild(header);

      const optionsDiv = document.createElement('div');
      optionsDiv.className = 'options';

      q.options.forEach((opt, oi) => {
        const optId = `q${q.id}_opt${oi}`;
        const label = document.createElement('label');
        label.className = 'option-label';
        label.htmlFor = optId;
        label.innerHTML = `<input id="${optId}" type="radio" name="q_${q.id}" value="${escapeHtml(opt.t)}" data-correct="${opt.c}" required> <span>${escapeHtml(opt.t)}</span>`;
        optionsDiv.appendChild(label);
      });

      qDiv.appendChild(optionsDiv);
      container.appendChild(qDiv);
    });
  }

  // Collect answers & score
  function collectAndScore(){
    let score = 0;
    const answers = [];
    for(const q of mcQuestions){
      const name = `q_${q.id}`;
      const radios = document.getElementsByName(name);
      let answered = false;
      for(const r of radios){
        if(r.checked){
          answered = true;
          answers.push({ id: q.id, answer: r.value });
          if(r.dataset.correct === "true") score++;
          break;
        }
      }
      if(!answered){
        answers.push({ id: q.id, answer: "" });
      }
    }
    return {score, answers};
  }

  // Send to Google Sheet
  async function sendToSheet(payload){
    if(!SCRIPT_URL || !SCRIPT_URL.startsWith('https://script.google.com/')){
      console.warn('SCRIPT_URL not set - skipping POST to Google Sheet.');
      return {ok:false, message:'No script URL provided.'};
    }
    try{
      const resp = await fetch(SCRIPT_URL, {
        method:'POST',
        mode:'cors',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(payload)
      });
      const j = await resp.json();
      return {ok:true, result:j};
    }catch(err){
      console.error('Send error', err);
      return {ok:false, message: err.message || String(err)};
    }
  }

  // Form handler
  async function handleSubmit(e){
    e.preventDefault();
    const form = document.getElementById('testForm');
    if(!form.checkValidity()){
      form.reportValidity();
      return false;
    }

    const result = collectAndScore();
    const score = result.score;
    const total = mcQuestions.length; // 50
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();

    const payload = {
      timestamp: new Date().toISOString(),
      name,
      email,
      score,
      total,
      answers: result.answers
    };

    alert(`Your score: ${score} / ${total}\n\nThank you for completing the test!`);

    // best-effort send
    sendToSheet(payload).then(res=>{
      if(!res.ok) console.warn('Submission not saved:', res.message);
    });

    // reset & reshuffle
    form.reset();
    document.querySelectorAll('input[type=radio]').forEach(i=>i.checked=false);
    renderMCQs();
    window.scrollTo({top:0, behavior:'smooth'});
    return false;
  }

  // Restart-on-leave
  window.addEventListener('beforeunload', function(e){
    const f = document.getElementById('testForm');
    if(f) f.reset();
  });

  // init
  renderMCQs();
  </script>
</body>
</html>
